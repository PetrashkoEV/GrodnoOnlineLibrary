(function(n){jQuery.fn.moreorless=function(t,i,r){t=t||100;i=i||"more";r=r||"less";this.each(function(){this.element=n(this);this.div_height=0;this.forceHeight=!1;this.link||(this.link=n(document.createElement("div")).css({cursor:"pointer"}),this.link.addClass("moreorless_link"));this.content||(this.content=this.element.wrap("<div><\/div>").parent(),this.content.addClass("moreorless_content expanded"));this.wrapper||(this.wrapper=this.content.wrap("<div><\/div>").parent(),this.wrapper.addClass("moreorless_wrapper").css("position","relative"));this.expand=function(n){return this.link.remove(),n?(this.link.html(r),n!=this.div_expanded&&this.content.addClass("expanded").animate({height:this.div_height},function(n){return function(){n.css("overflow","").height("inherit")}}(this.content)),this.forceHeight&&this.content.after(this.link)):(this.link.html(i),n!=this.div_expanded&&this.content.removeClass("expanded").animate({height:t},function(n){return function(){n.css("overflow","hidden")}}(this.content)),this.content.after(this.link)),this.link.unbind().bind("click",function(n){return function(t){t.preventDefault();t.stopPropagation();var i=!n.content.hasClass("expanded");n.forceHeight=i;n.expand(i)}}(this)),this.div_expanded=n,this.content};this.checkHeight=function(){this.forceHeight=!1;this.div_height=this.element.height();this.expand(this.div_height<t)};var u=0;n(window).unbind("resize").bind("resize",function(n){return function(){clearTimeout(u);u=setTimeout(function(){n.checkHeight()},100)}}(this));this.element.unbind("resize").bind("resize",function(n){return function(){clearTimeout(u);u=setTimeout(function(){n.checkHeight()},100)}}(this));this.checkHeight()})}})(jQuery),function(n){Object.keys||(Object.keys=function(){"use strict";var t=Object.prototype.hasOwnProperty,i=!{toString:null}.propertyIsEnumerable("toString"),n=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],r=n.length;return function(u){if(typeof u!="object"&&(typeof u!="function"||u===null))throw new TypeError("Object.keys called on non-object");var e=[],o,f;for(o in u)t.call(u,o)&&e.push(o);if(i)for(f=0;f<r;f++)t.call(u,n[f])&&e.push(n[f]);return e}}());n.fn.treeselect=function(t){t=n.extend({colwidth:18,default_value:{},selected:null,treeloaded:null,load:null,searcher:null,deepLoad:!1,onbuild:null,postbuild:null,inputName:"treeselect",autoSelectChildren:!0,showRoot:!1,selectAll:!1,selectAllText:"Select All"},t);var u={},r="treebusy-loading",f="treebusy-loading-all",e="treebusy-selecting",i=function(t,i){this.root=!!i;t.title=t.title||"anonymous";n.extend(this,{id:0,nodeloaded:!1,allLoaded:!1,value:0,title:"",url:"",has_children:!0,children:[],data:{},level:0,odd:!1,checked:!1,busy:!1,display:n(),input:n(),link:n(),span:n(),childlist:n(),exclude:{}},t);this.isTreeNode=!0;this.loading=!1;this.loadqueue=[]};return i.prototype.setBusy=function(n,t){if(n!=this.span.hasClass(t))if(this.busy=n,n)this.span.addClass(t),this.span.addClass("treebusy");else{this.span.removeClass(t);var i=t==r?e:r;this.span.hasClass(i)||this.span.removeClass("treebusy")}},i.prototype.isLoaded=function(){var n=this.nodeloaded;return n|=u.hasOwnProperty(this.id),n|=!this.has_children,n|(this.has_children&&this.children.length>0)},i.prototype.loadNode=function(n,i){if(this.loading){n&&this.loadqueue.push(n);return}var f=function(){n&&n(this);for(var t in this.loadqueue)this.loadqueue[t](this);this.loadqueue.length=0;i||this.setBusy(!1,r)};this.loading=!0;t.load&&!this.isLoaded()?(i||this.setBusy(!0,r),t.load(this,function(n){return function(t){n.nodeloaded?f.call(n):(n=jQuery.extend(n,t),n.nodeloaded=!0,u[n.id]=n.id,n.build(function(){f.call(n)}))}}(this))):n&&f.call(this);this.loading=!1},i.prototype.loadAll=function(n,t,i,r){r=r||{};this.loadNode(function(u){var e,o,s;if(t&&t(u),e=u.children.length,o=e,!e||r.hasOwnProperty(u.id)){n&&n.call(u,u);return}for(r[u.id]=u.id,i||u.setBusy(!0,f),s=function(e){return function(){u.children[e].loadAll(function(){o--;o||(n&&n.call(u,u),i||u.setBusy(!1,f))},t,i,r)}};e--;)setTimeout(s(e),2)})},i.prototype.expand=function(n){n?(this.link.removeClass("collapsed").addClass("expanded"),this.span.removeClass("collapsed").addClass("expanded"),this.childlist.show("fast"),!t.deepLoad&&this.checked&&this.include_children&&(this.include_children=!1,this.selectChildren(!0))):this.span.length>0&&(this.link.removeClass("expanded").addClass("collapsed"),this.span.removeClass("expanded").addClass("collapsed"),this.childlist.hide("fast"));n&&!this.isLoaded()&&this.loadNode(function(n){n.checked&&n.selectChildren(n.checked);n.expand(!0)})},i.prototype.selectChildren=function(i,r,u){var h=typeof i=="object",s=function(){u||(t.selected&&t.selected(this,!0),r&&r.call(this))},f,o;if(t.deepLoad)this.loadAll(function(){this.setBusy(!1,e);s.call(this)},function(n){var t=i;h&&(t=i.hasOwnProperty(n.value)|i.hasOwnProperty(n.id));n.select(t)});else{if(this.select(i),f=t.inputName+"-"+this.value,n('input[name="'+f+'-include-below"]').attr("name",f),this.root!==!0&&(i!==!1||this.include_children)&&(this.link===undefined||this.link[0]===undefined||this.link[0].className.indexOf("expanded")===-1))this.has_children>0&&i&&(this.include_children=!0,n('input[name="'+f+'"]').attr("name",f+"-include-below"));else for(this.include_children=!1,this.expand(i),o=this.children.length;o--;)this.children[o].selectChildren(i,r,!0);s.call(this)}},i.prototype.selectDefaults=function(i,r){var e=Object.keys(i).length,s=[],u,f,o,h;for(s.push(this);e>0&&s.length>0;)if(u=s.shift(),f=!1,i.hasOwnProperty(u.value)&&(delete i[u.value],f=!0,e--),i.hasOwnProperty(u.id)&&(delete i[u.id],f=!0,e--),i.hasOwnProperty(u.value+"-include-below")&&(delete i[u.value+"-include-below"],u.include_children=!0,f=!0,e--),i.hasOwnProperty(u.id+"-include-below")&&(delete i[u.id+"-include-below"],u.include_children=!0,f=!0,e--),u.select(f),o=t.inputName+"-"+u.value,n('input[name="'+o+'-include-below"]').attr("name",o),!u.root&&f&&u.include_children)n('input[name="'+o+'"]').attr("name",o+"-include-below");else if(e>0)for(h=u.children.length;h--;)s.push(u.children[h]);else u.root&&u.include_children&&u.selectChildren(!0);t.selected&&t.selected(this,!0);r&&r.call(this)},i.prototype.select=function(i){this.input.hasClass("treenode-no-select")||(i=!!i,(i||!this.root||this.showRoot&&this.has_children)&&(this.checked=i,this.input.attr("checked",i),n('input[name="'+this.input.attr("name")+'"]').change(),t.selected&&t.selected(this)))},i.prototype.build_treenode=function(){var t=n();return t=n(document.createElement(this.root?"div":"li")),t.addClass("treenode"),t.addClass(this.odd?"odd":"even"),t},i.prototype.build_input=function(i){if(t.inputName){if(typeof this.exclude[this.id]=="undefined"&&(t.inputName!="group_finder"||this.data.roles_enabled)){this.input=n(document.createElement("input"));var r=this.value||this.id;this.input.attr({type:"checkbox",value:r,name:t.inputName+"-"+r,checked:this.checked}).addClass("treenode-input");this.input.bind("click",function(i){return function(r){i.checked=n(r.target).is(":checked");t.autoSelectChildren&&((!i.checked||t.deepLoad)&&i.expand(i.checked),i.selectChildren(i.checked))}}(this));this.root&&!t.showRoot&&this.input.hide()}else this.input=n(document.createElement("div")),this.input.addClass("treenode-no-select");this.input.css("left",i+"px")}return this.input},i.prototype.build_link=function(t){return t.css("cursor","pointer").addClass("collapsed"),t.bind("click",{node:this},function(t){t.preventDefault();t.data.node.expand(n(t.target).hasClass("collapsed"))}),t},i.prototype.build_span=function(t){return(!this.root||this.showRoot)&&this.has_children&&(this.span=this.build_link(n(document.createElement("span")).attr({"class":"treeselect-expand"})),this.span.css("left",t+"px")),this.span},i.prototype.build_title=function(t){return(!this.root||this.showRoot)&&this.title&&(this.nodeLink=n(document.createElement("a")).attr({"class":"treeselect-title",href:this.url,target:"_blank"}).css("marginLeft",t+"px").text(this.title),this.link=this.has_children?this.build_link(this.nodeLink.clone()):n(document.createElement("div")).attr({"class":"treeselect-title"}).css("marginLeft",t+"px").text(this.title)),this.link},i.prototype.build_children=function(t){var r;if(this.childlist=n(),this.children.length>0){this.childlist=n(document.createElement("ul"));var u=this.odd,f=this.children.length,e=function(n,i){return function(){n.children[i].build(function(i){f--;n.childlist.append(i.display);f||t.call(n,n.childlist)})}};for(r in this.children)this.children.hasOwnProperty(r)&&(u=!u,this.children[r]=new i(n.extend(this.children[r],{level:this.level+1,odd:u,checked:this.checked,exclude:this.exclude})),setTimeout(e(this,r),2))}else t.call(this,this.childlist)},i.prototype.build=function(i){var r=5,u=null,f,e;this.display.length===0?this.display=this.build_treenode():this.root&&(f=this.build_treenode(),this.display.append(f),this.display=f);this.input.length===0&&(u=this.build_input(r))&&u.length>0&&(this.display.append(u),r+=t.colwidth);this.span.length===0&&(this.display.append(this.build_span(r)),r+=t.colwidth);this.link.length===0&&this.display.append(this.build_title(r));e=function(){if(t.onbuild)t.onbuild(this);this.searchItem=this.display.clone();n(".treeselect-expand",this.searchItem).remove();var r=n("div.treeselect-title",this.searchItem);r.length>0&&r.replaceWith(this.nodeLink);t.postbuild&&t.postbuild(this);typeof this.exclude[this.id]!="undefined"&&n(".treenode-input",this.display).length===0&&this.display.hide();i&&i.call(this,this)};this.childlist.length===0?this.build_children(function(n){n.length>0&&this.display.append(n);e.call(this)}):e.call(this)},i.prototype.getSelectAll=function(){return this.root&&this.selectAll?this.selectAllText:!1},i.prototype.search=function(n,r){if(n){var f={};n=n.toLowerCase();t.searcher?t.searcher(this,n,function(n,t){var s=Object.keys(n).length,h,o,e;s===0&&r(f,!0);h=function(n){return function(t){s--;f[n]=t;s||r(f,!0)}};for(o in n)e=new i(t?t(n[o]):n[o]),e.nodeloaded=!0,u[e.id]=e.id,e.build(h(o))}):this.loadAll(function(){r&&r(f,!0)},function(t){t.root||t.title.toLowerCase().search(n)===-1||(f[t.id]=t)},!0)}else r&&r(this.children,!1)},n(this).each(function(){var c=n.extend(t,{display:n(this)}),r=this.treenode=new i(c,!0),f=r.getSelectAll(),e,s,h,o,u;f===!1||r.showRoot||(e=!1,s=t.default_value,s.hasOwnProperty(r.value+"-include-below")&&(e=!0),r.display.append(n(document.createElement("input")).attr({type:"checkbox",checked:e}).bind("click",function(t){return function(i){t.selectChildren(n(i.target).is(":checked"))}}(r))),f&&(h=n(document.createElement("span")).attr({"class":"treeselect-select-all"}).html(f),r.display.append(h)));o=n(document.createElement("span")).addClass("treebusy");r.display.append(o.css("display","block"));u=function(){o.remove();t.treeloaded&&t.treeloaded(this)};r.loadNode(function(n){n.children.length===0&&n.display.hide();n.expand(!0);n.select(n.checked);var i=n.checked;jQuery.isEmptyObject(t.default_value)||(i=t.default_value);i?t.deepLoad?n.selectChildren(i,function(){u.call(n)}):n.selectDefaults(i,function(){u.call(n)}):u.call(n)});r.has_children||(this.parentElement.style.display="none")})}}(jQuery),function(n){n.fn.chosentree=function(t){return t=n.extend({inputId:"chosentree-select",label:"",description:"",input_placeholder:"Select Item",input_type:"text",autosearch:!1,search_text:"Search",no_results_text:"No results found",min_height:100,more_text:"+%num% more",loaded:null,collapsed:!0,showtree:!1},t),n(this).each(function(){var e=null,r=null,f=null,i=null,h=null,c=null,a=null,l=null,o=null,u=null,v=function(n,t){t=t||"fast";n&&(!u||u.has_children)?o.addClass("treevisible").show("fast"):o.removeClass("treevisible").hide("fast")},y,p,s;e=n(document.createElement("div"));e.addClass("chzntree-container");t.input_type=="search"?(e.addClass("chzntree-container-single"),f=n(document.createElement("div")),f.addClass("chzntree-search")):(e.addClass("chzntree-container-multi"),r=n(document.createElement("ul")),r.addClass("chzntree-choices chosentree-choices navbar-inner"),f=n(document.createElement("li")),f.addClass("search-field"));c=n(document.createElement("label"));c.attr({"for":t.inputId});c.text(t.label);a=n(document.createElement("div"));a.attr({"class":"description"});a.text(t.description);t.input_placeholder&&(i=n(document.createElement("input")),i.attr({type:"text",placeholder:t.input_placeholder,autocomplete:"off"}),!t.showtree&&t.collapsed&&i.focus(function(){v(!0)}),t.input_type=="search"?(i.addClass("chosentree-search"),y=function(n){return!i.hasClass("searching")&&n.length!==1&&u?(i.addClass("searching"),u.search(n,function(n,r){var f,e,o;i.removeClass("searching");f=0;u.childlist.children().detach();r?u.childlist.addClass("chzntree-search-results"):u.childlist.removeClass("chzntree-search-results");t.inputName!==""?u.childlist.addClass("input-enabled"):u.childlist.removeClass("input-enabled");for(e in n)f++,r?u.childlist.append(n[e].searchItem):u.childlist.append(n[e].display);f||(o="<li>"+t.no_results_text+"<\/li>",u.childlist.append(o))}),!0):!1},t.autosearch?(p=0,i.bind("input",function w(){y(i.val())||(clearTimeout(p),p=setTimeout(w,1e3))}),f.addClass("autosearch")):(h=n(document.createElement("input")),h.attr({type:"button",value:t.search_text}),h.addClass("button chosentree-search-btn"),h.bind("click",function(n){n.preventDefault();y(i.val())}),jQuery(document).bind("keydown",function(n){n.keyCode==13&&i.is(":focus")&&(n.preventDefault(),y(i.val()))}),f.addClass("manualsearch"))):i.addClass("chosentree-results"),f.append(i),h&&f.append(h));r?e.append(c).append(r.append(f)):e.append(c).append(f);o=n(document.createElement("div"));o.addClass("treewrapper navbar-inner");o.hide();l=n(document.createElement("div"));l.addClass("treeselect");n(this).keyup(function(n){n.which==27&&v(!1)});o.append(l);n(this).append(e.append(o));n(this).append(a);s=t;s.selected=function(u){var f={};return function(e,o){var l,p,y,c,a,h,w,b;if(e.id&&(l=n("li#choice_"+e.id,r),e.checked?(l.length!==0&&l.remove(),f[e.id]=e):e.checked||l.remove()),o){u.value={};p=function(t){return function(i){i.preventDefault();t=this.parentNode.nodeData;n("li#choice_"+t.id,r).remove();t.selectChildren(!1)}};for(y in f)e=f[y],u.value[y]=e,c=n(document.createElement("li")),c.addClass("search-choice"),c.attr("id","choice_"+e.id),c.eq(0)[0].nodeData=e,a=n(document.createElement("span")),!t.deepLoad&&e.include_children?a.text(e.title+" (All below)"):a.text(e.title),h="",(!e.root||e.showRoot&&e.has_children)&&(h=n(document.createElement("a")),h.addClass("search-choice-close"),h.attr("href","#"),h.bind("click",p(e))),r&&r.prepend(c.append(a).append(h));r&&(r.is(":visible")||r.show(),f={},i&&e.children.length===0&&i.attr({value:""}),jQuery.fn.moreorless&&(w=n("li.search-choice",r).length,b=t.more_text.replace("%num%",w),r.moreorless(t.min_height,b),r.div_expanded||v(!0,null)));s.loaded&&s.loaded(nodes);n(u).trigger("treeloaded")}}}(this);l.treeselect(s);u=l.eq(0)[0].treenode;(s.showtree||!s.collapsed)&&v(!0,null)})}}(jQuery);
/*
//# sourceMappingURL=jquery.treeselect.min.js.map
*/